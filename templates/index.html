<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>2D å¼€å¥–ç³»ç»Ÿ</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <style>
        .head, .special {
            display: inline-block;
            padding: 6px 12px;
            margin: 3px;
            font-weight: bold;
            border-radius: 4px;
            background-color: #f1f1f1;
            min-width: 40px;
            text-align: center;
            font-size: 18px;
            border: 1px solid #ccc;
        }

        .blank {
            background-color: #e0e0e0;
            color: #999;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>2D å¼€å¥–é¡µé¢</h1>
        <a href="javascript:void(0)" onclick="startDraw()" class="draw-button">ğŸ¯ å¼€å¥–</a>

        <!-- åŠ¨æ€æ’å…¥å¼€å¥–åŒº -->
        <div id="draw-area"></div>
    </div>

    <script>
        function startDraw() {
            fetch('/draw')
                .then(res => res.json())
                .then(data => {
                    const drawBox = document.createElement('div');
                    drawBox.className = 'draw-box';

                    // å±€å·
                    const title = document.createElement('h2');
                    title.textContent = `å±€å·ï¼š${data.code}`;
                    drawBox.appendChild(title);

                    // å¤´å¥–æ¡†ï¼ˆå…ˆæ˜¾ç¤ºç©ºï¼‰
                    const head = document.createElement('p');
                    head.innerHTML = `<strong>å¤´å¥–ï¼š</strong> <span id="head-number-${data.code}" class="head blank">--</span>`;
                    drawBox.appendChild(head);

                    // ç‰¹åˆ«å¥–æ¡†ï¼ˆå…ˆæ˜¾ç¤º6ä¸ªç©ºï¼‰
                    const special = document.createElement('p');
                    special.innerHTML = `<strong>ç‰¹åˆ«å¥–ï¼š</strong> `;
                    const specialArea = document.createElement('span');
                    specialArea.id = `special-numbers-${data.code}`;
                    for (let i = 0; i < 6; i++) {
                        const span = document.createElement('span');
                        span.className = 'special blank';
                        span.id = `special-${data.code}-${i}`;
                        span.textContent = '--';
                        specialArea.appendChild(span);
                    }
                    special.appendChild(specialArea);
                    drawBox.appendChild(special);

                    // æ’å…¥é¡µé¢é¡¶éƒ¨
                    document.getElementById('draw-area').prepend(drawBox);

                    // å¡«å…¥ç‰¹åˆ«å¥–æ•°å­—ï¼ˆæ¯ 5 ç§’ä¸€ä¸ªï¼‰
                    let i = 0;
                    const nums = data.special.slice();

                    const interval = setInterval(() => {
                        if (i < nums.length) {
                            const span = document.getElementById(`special-${data.code}-${i}`);
                            span.textContent = nums[i];
                            span.classList.remove('blank');
                            i++;
                        } else {
                            clearInterval(interval);

                            // ç­‰ 10 ç§’åå…¬å¸ƒå¤´å¥–
                            setTimeout(() => {
                                const chosen = nums[Math.floor(Math.random() * nums.length)];
                                const headSpan = document.getElementById(`head-number-${data.code}`);
                                headSpan.textContent = chosen;
                                headSpan.classList.remove('blank');

                                // ä»ç‰¹åˆ«å¥–ä¸­ç§»é™¤å¤´å¥–æ•°å­—
                                for (let j = 0; j < 6; j++) {
                                    const s = document.getElementById(`special-${data.code}-${j}`);
                                    if (s.textContent === chosen) {
                                        s.textContent = '--';
                                        s.classList.add('blank');
                                        break;
                                    }
                                }
                            }, 10000);
                        }
                    }, 5000);
                });
        }
    </script>
</body>
</html>
